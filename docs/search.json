[
  {
    "objectID": "quarto/preconditioning.html",
    "href": "quarto/preconditioning.html",
    "title": "Preconditioning",
    "section": "",
    "text": "Each iteration of the preconditioned Newton CG method approximately solves the trust-region subproblem \\[\n\\min_{s} \\{\\tfrac{1}{2} \\langle s, H_k s \\rangle + \\langle \\nabla f_k,s  \\rangle \\mid \\|s\\|_M \\leq \\Delta\\}\n\\] where \\(\\nabla f_k\\) and \\(H_k\\) are the current gradient and Hessian, and \\(M\\approx H\\) is a positive definite preconditioner. For the KL regularized LS problem, \\[\nH_k = A S_k A^T + \\lambda I, \\quad S_k:= X_k - x_k x_k^T\n\\] where \\(x_k\\) is the current primal iterate and \\(X_k=\\operatorname{Diag}(x_k)\\).\nWe consider these preconditioners:\n\nDiagonal, constant: \\(M = \\operatorname{Diag}(AA^T) + \\lambda I\\)\n(not working) Diagonal, variable: \\(M = \\operatorname{Diag}(AX_kA^T) + \\lambda I\\)\n(not yet implemented) Cholesky, constant: \\(M = AA^T + \\lambda I\\)\n\nThe first two preconditioners have complexity \\(O(mn)\\) to compute and \\(O(m)\\) to apply. The third has cubic complexity, but that cost can be amortized over the Newton iterations.\n\n\nCode\nusing LinearAlgebra, NPZ, StatsPlots\nimport KLLS: KLLSModel, DiagAAPreconditioner, DiagASAPreconditioner, solve!\n\n\nLoad the synthetic UEG test problem:\n\ndata = try # needed because of vscode quirks while developing\n    npzread(\"../data/synthetic-UEG_testproblem.npz\")\ncatch\n    npzread(\"./data/synthetic-UEG_testproblem.npz\")\nend\nkldata = KLLSModel(data[\"A\"], data[\"b_avg\"])\n\nKL regularized least-squares\n\n\n   m =   201  bNrm = 3.8e+00\n   n =   500  Î»    = 1.5e-08\n\n\nBuild the preconditioner object:\n\nMAA = DiagAAPreconditioner(kldata);\n# MASA = DiagASAPreconditioner(kldata) # NOT WORKING! ðŸ˜¢\n\nSolve the problem with and without preconditioning:\n\nkldata.Î»=1e-6\nstatsI = solve!(kldata, trace=true)\nstatsMAA = solve!(kldata, trace=true, M=MAA)\n# statsMASA = solve!(kldata, trace=true, M=MASA)\n\n\n\n\n\nOptimality conditions satisfied\nProducts with A   :       414\nProducts with A'  :       878\nTime elapsed (sec):       0.0\nResidual norm     :   1.3e-02\nOptimality        :   8.3e-12\n\n\nPlot the dual objective value and cumulative CG iterations."
  }
]