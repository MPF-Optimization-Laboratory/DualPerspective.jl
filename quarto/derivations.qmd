---
title: "Cross Entropy under Linear Constraints"
subtitle: "A dual Newton solver"
authors:
  - name: "Nicholas Barnfield"
  - name: "Michael P. Friedlander"
  - name: "Tim Hoheisel"
date-modified: last-modified
date: April 3, 2024 
format:
  html: default
  typst: default
execute:
  cache: true
  freeze: auto
---

\newcommand{\logexp}{\mathop{\mathrm{logexp}}}
\newcommand{\cent}{\mathop{\mathrm{cent}}}
\newcommand{\ip}[1]{\langle #1 \rangle}

## Problem statement

Define the cross-entropy and log-exponential functions by
$$
\begin{aligned}
\cent(p \mid q) &= \sum_{i=1}^n p_i \log(p_i/q_i), \\
\logexp(p \mid q) &= \log\sum_{i=1}^n q_i\exp(p_i),
\end{aligned}
$$
which form a conjugate pair.  We consider the pair of dual optimization problems
$$
\begin{aligned}
\min_{p,\, y } &\enspace\left\{\cent(p \mid q) + \lambda/2\|y\|^2 \mid Ax + \lambda y = b\right\}\\
\min_{y} &\enspace\left\{\logexp(A^Ty \mid q) + \lambda/2\|y\|^2 - \ip{b,y}\right\},
\end{aligned}
$$
where $A$ is an $m$-by-$n$ matrix, $b$ is an $m$-vector, and $\lambda$ is a nonnegative regularization parameter.

## Implicit approach

### Optimality conditions

A pair $(p, y)$ is primal-dual optimal if and only if it satisfies the optimality conditions
$$
\begin{aligned}
b &= Ax + \lambda y, \\
x_j &= \frac{1}{\sigma(x)}{q_j\exp(\ip{a_j,y})}, \quad j\in[n],\\
\sigma(x) &= \sum_{j=1}^n q_j\exp(\ip{a_j,y}),
\end{aligned}
$$
